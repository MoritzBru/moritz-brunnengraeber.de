"use strict";!function(){function e(e){return e.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")}function t(t){o(),t.view.setParameters(t.data.initialViewParameters),t.scene.switchTo(),n(),function(t){u.innerHTML=e(t.data.name)}(t),function(e){for(var t=0;t<p.length;t++){var n=p[t];n.getAttribute("data-id")===e.data.id?n.classList.add("current"):n.classList.remove("current")}}(t),function(t){f.innerHTML=e(t.data.coords),f.href="https://www.google.com/maps/search/?api=1&query="+t.data.coords.replace(" |",",")}(t)}function n(){v.classList.contains("enabled")&&(y.startMovement(M),y.setIdleMovement(3e3,M))}function o(){y.stopMovement(),y.setIdleMovement(1/0)}function s(e){var n=document.createElement("div");n.classList.add("hotspot"),n.classList.add("link-hotspot");var o=document.createElement("img");o.src="img/link.png",o.classList.add("link-hotspot-icon");for(var s=["-ms-transform","-webkit-transform","transform"],i=0;i<s.length;i++){var d=s[i];o.style[d]="rotate("+e.rotation+"rad)"}n.addEventListener("click",function(){t(function(e){for(var t=0;t<E.length;t++)if(E[t].data.id===e)return E[t];return null}(e.target))}),a(n);var c=document.createElement("div");return c.classList.add("hotspot-tooltip"),c.classList.add("link-hotspot-tooltip"),c.innerHTML=function(e){for(var t=0;t<r.scenes.length;t++)if(r.scenes[t].id===e)return r.scenes[t];return null}(e.target).name,n.appendChild(o),n.appendChild(c),n}function a(e,t){for(var t=["touchstart","touchmove","touchend","touchcancel","wheel","mousewheel"],n=0;n<t.length;n++)e.addEventListener(t[n],function(e){e.stopPropagation()})}var i=window.Marzipano,d=window.bowser,c=window.screenfull,r=window.APP_DATA,l=document.querySelector("#pano"),u=document.querySelector("#titleBar .sceneName"),m=document.querySelector("#sceneList"),p=document.querySelectorAll("#sceneList .scene"),h=document.querySelector("#sceneListToggle"),v=document.querySelector("#autorotateToggle"),L=document.querySelector("#fullscreenToggle"),f=document.querySelector("#coordinates");if(window.matchMedia){var w=function(){g.matches?(document.body.classList.remove("desktop"),document.body.classList.add("mobile")):(document.body.classList.remove("mobile"),document.body.classList.add("desktop"))},g=matchMedia("(max-width: 500px), (max-height: 500px)");w(),g.addListener(w)}else document.body.classList.add("desktop");document.body.classList.add("no-touch"),window.addEventListener("touchstart",function(){document.body.classList.remove("no-touch"),document.body.classList.add("touch")}),d.msie&&parseFloat(d.version)<11&&document.body.classList.add("tooltip-fallback");var b={controls:{mouseViewMode:r.settings.mouseViewMode}},y=new i.Viewer(l,b),E=r.scenes.map(function(e){var t=i.ImageUrlSource.fromString("tiles/"+e.id+"/{z}/{f}/{y}/{x}.jpg",{cubeMapPreviewUrl:"tiles/"+e.id+"/preview.jpg"}),n=new i.CubeGeometry(e.levels),o=i.RectilinearView.limit.traditional(e.faceSize,100*Math.PI/180,120*Math.PI/180),d=new i.RectilinearView(e.initialViewParameters,o),c=y.createScene({source:t,geometry:n,view:d,pinFirstLevel:!0});return e.linkHotspots.forEach(function(e){var t=s(e);c.hotspotContainer().createHotspot(t,{yaw:e.yaw,pitch:e.pitch})}),e.infoHotspots.forEach(function(e){var t=function(e){var t=document.createElement("div");t.classList.add("hotspot"),t.classList.add("info-hotspot");var n=document.createElement("div");n.classList.add("info-hotspot-header");var o=document.createElement("div");o.classList.add("info-hotspot-icon-wrapper");var s=document.createElement("img");s.src="img/info.png",s.classList.add("info-hotspot-icon"),o.appendChild(s);var i=document.createElement("div");i.classList.add("info-hotspot-title-wrapper");var d=document.createElement("div");d.classList.add("info-hotspot-title"),d.innerHTML=e.title,i.appendChild(d);var c=document.createElement("div");c.classList.add("info-hotspot-close-wrapper");var r=document.createElement("img");r.src="img/close.png",r.classList.add("info-hotspot-close-icon"),c.appendChild(r),n.appendChild(o),n.appendChild(i),n.appendChild(c);var l=document.createElement("div");l.classList.add("info-hotspot-text"),l.innerHTML=e.text,t.appendChild(n),t.appendChild(l);var u=document.createElement("div");u.innerHTML=t.innerHTML,u.classList.add("info-hotspot-modal"),document.body.appendChild(u);var m=function(){t.classList.toggle("visible"),u.classList.toggle("visible")};return t.querySelector(".info-hotspot-header").addEventListener("click",m),u.querySelector(".info-hotspot-close-wrapper").addEventListener("click",m),a(t),t}(e);c.hotspotContainer().createHotspot(t,{yaw:e.yaw,pitch:e.pitch})}),{data:e,scene:c,view:d}}),M=i.autorotate({yawSpeed:.03,targetPitch:0,targetFov:Math.PI/2});r.settings.autorotateEnabled&&v.classList.add("enabled"),v.addEventListener("click",function(){v.classList.contains("enabled")?(v.classList.remove("enabled"),o()):(v.classList.add("enabled"),n())}),c.enabled&&r.settings.fullscreenButton?(document.body.classList.add("fullscreen-enabled"),L.addEventListener("click",function(){c.toggle()}),c.on("change",function(){c.isFullscreen?L.classList.add("enabled"):L.classList.remove("enabled")})):document.body.classList.add("fullscreen-disabled"),h.addEventListener("click",function(){m.classList.toggle("enabled"),h.classList.toggle("enabled")}),document.body.classList.contains("mobile")||(m.classList.add("enabled"),h.classList.add("enabled")),E.forEach(function(e){document.querySelector('#sceneList .scene[data-id="'+e.data.id+'"]').addEventListener("click",function(){t(e),document.body.classList.contains("mobile")&&(m.classList.remove("enabled"),h.classList.remove("enabled"))})});var S=document.querySelector("#viewUp"),C=document.querySelector("#viewDown"),q=document.querySelector("#viewLeft"),k=document.querySelector("#viewRight"),P=document.querySelector("#viewIn"),T=document.querySelector("#viewOut"),H=y.controls();H.registerMethod("upElement",new i.ElementPressControlMethod(S,"y",-.7,3),!0),H.registerMethod("downElement",new i.ElementPressControlMethod(C,"y",.7,3),!0),H.registerMethod("leftElement",new i.ElementPressControlMethod(q,"x",-.7,3),!0),H.registerMethod("rightElement",new i.ElementPressControlMethod(k,"x",.7,3),!0),H.registerMethod("inElement",new i.ElementPressControlMethod(P,"zoom",-.7,3),!0),H.registerMethod("outElement",new i.ElementPressControlMethod(T,"zoom",.7,3),!0),t(E[0])}();